function insert_ticket_knowledgebase_link(a){$.get(admin_url+"knowledge_base/get_article_by_id_ajax/"+a,function(a){$('textarea[name="message"]');tinymce.activeEditor.execCommand("mceInsertContent",!1,site_url+"knowledge_base/"+a.slug),$("#insert_knowledge_base_link").modal("hide")},"json")}function tickets_bulk_action(a){var b=confirm(confirm_action_prompt);if(0==b)return!1;var c=$("#mass_delete").prop("checked"),d=[],e={};if(0==c||"undefined"==typeof c){if(e.status=$("#move_to_status_tickets_bulk").val(),e.department=$("#move_to_department_tickets_bulk").val(),e.priority=$("#move_to_priority_tickets_bulk").val(),e.service=$("#move_to_service_tickets_bulk").val(),""==e.status&&""==e.department&&""==e.priority&&""==e.service)return}else e.mass_delete=!0;var f=$(".table-tickets").find("tbody tr");$.each(f,function(){var a=$($(this).find("td").eq(0)).find("input");1==a.prop("checked")&&d.push(a.val())}),e.ids=d,$(a).addClass("disabled"),setTimeout(function(){$.post(admin_url+"tickets/bulk_action",e).done(function(){window.location.reload()})},50)}$(function(){$(".add_predefined_reply").on("click",function(a){a.preventDefault();var b=$(this).parents("li").find(".message").html();tinymce.activeEditor.execCommand("mceInsertContent",!1,b),$("#insert_predefined_reply").modal("hide")}),$(".block-sender").on("click",function(){var a=$(this).data("sender");return""==a?(alert("No Sender Found"),!1):void $.post(admin_url+"tickets/block_sender",{sender:a}).done(function(){window.location.reload()})}),$(".add_note_ticket").on("click",function(a){a.preventDefault();var b=$('textarea[name="note_description"]').val(),c=$('input[name="ticketid"]').val();""!=b&&$.post(admin_url+"misc/add_note/"+c+"/ticket",{description:b}).done(function(){window.location.reload()})}),$(".save_changes_settings_single_ticket").on("click",function(a){a.preventDefault();var b={},c=$('select[name="service"]').val();b.subject=$('input[name="subject"]').val(),b.userid=$('input[name="userid"]').val(),b.contactid=$('select[name="contactid"]').val(),b.department=$('select[name="department"]').val(),b.priority=$('select[name="priority"]').val(),b.ticketid=$('input[name="ticketid"]').val(),b.assigned=$('select[name="assigned"]').val(),b.project_id=$('select[name="project_id"]').val(),b.tags=$("#tags").tagit("assignedTags"),b.custom_fields=[];$('[name^="custom_fields"]').map(function(){b.custom_fields.push([$(this).data("fieldto"),$(this).data("fieldid"),this.value])}).get(),"undefined"!=typeof c&&(b.service=c),$.post(admin_url+"tickets/update_single_ticket_settings",b).done(function(a){a=JSON.parse(a),1==a.success&&("undefined"!=typeof a.department_reassigned?window.location.href=admin_url+"tickets/":window.location.reload())})}),$('select[name="status_top"]').on("change",function(){var a=$(this).val(),b=$('input[name="ticketid"]').val();$.get(admin_url+"tickets/change_status_ajax/"+b+"/"+a,function(a){alert_float(a.alert,a.message)},"json")}),$('body.ticket select[name="contactid"]').on("change",function(){var a=$(this).val();""!=a?$.post(admin_url+"tickets/ticket_change_data/",{contact_id:a}).done(function(a){a=JSON.parse(a),$('input[name="to"]').val(a.contact_data.firstname+" "+a.contact_data.lastname),$('input[name="email"]').val(a.contact_data.email),$('input[name="userid"]').val(a.contact_data.userid),$("#project_id").empty(),$("#project_id").append('<option value="0" selected></option>'),$.each(a.projects,function(a,b){$("#project_id").append('<option value="'+b.id+'">'+b.name+"</option>")}),$("#project_id").selectpicker("refresh")}):($('input[name="to"]').val(""),$('input[name="email"]').val(""),$('input[name="contactid"]').val(""))}),$(".add_more_attachments").on("click",function(){if($(this).hasClass("disabled"))return!1;var a=$('input[name="attachments[]"]').length;if(a>=maximum_allowed_ticket_attachments)return!1;var b=$(".attachments").find(".attachment").eq(0).clone().appendTo(".attachments");$(b).find("input").val(""),$(b).find("i").removeClass("fa-plus").addClass("fa-minus"),$(b).find("button").removeClass("add_more_attachments").addClass("remove_attachment").removeClass("btn-success").addClass("btn-danger")}),$("body").on("click",".remove_attachment",function(){$(this).parents(".attachment").remove()})});